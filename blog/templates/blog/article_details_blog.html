{% extends 'base.html' %}
{% comment %} {% extends 'blog/base_blog.html' %} {% endcomment %}
{% load static %}
{% block title %} {{ post.title_tag }} {% endblock title %}
{% block meta_description %} This is the blog of Dr.Dentis.{% endblock meta_description %} 
{% block content %}

        <!-- ***** Breadcrumb Area Start ***** -->
    <div class="breadcumb-area bg-img bg-gradient-overlay" style="background-image: url({% static 'website/img/bg-img/12.jpg' %});">
    <div class="container h-100">
        <div class="row h-100 align-items-center">
        <div class="col-12">
            <h2 class="title">Blog Details</h2>
        </div>
        </div>
    </div>
    </div>
    <div class="breadcumb--con">
    <div class="container">
        <div class="row">
        <div class="col-12">
            <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'home' %}"><i class="fa fa-home"></i> Home</a></li>
                <li class="breadcrumb-item" aria-current="page"><a href="{% url 'home_blog' %}">Blog</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ post.title}}</li>
            </ol>
            </nav>
        </div>
        </div>
    </div>
    </div>
    <!-- ***** Breadcrumb Area End ***** -->


    {% comment %} <h1> {{ post.title}} </h1>
    <small> 
        By: 
        {{ post.author.first_name}} 
        {{post.author.last_name}} --
        <a href="{% url 'category' post.category|slugify %}">{{post.category}} </a>
        {{ post.post_date}}  
        {% if user.is_authenticated %}
            {% if user.id == post.author.id %}
                - <a href="{% url 'update_post' post.pk %}" >Edit</a> 
                <a href="{% url 'delete_post' post.pk %}" >Delete</a> 
            {% endif %}
        {% endif %}
    </small>
    <br/>
    <hr>
    <br/>
    <!-- Start Form for article details  -->
    {% if post.header_image %}
        <img src="{{post.header_image.url}}">
    {% endif %}
    <br/><br/>
    {{post.body|safe}}
    <!-- End Form for article details  -->

    <br/><br/>
    <!-- Back Button -->
    <a href="{% url 'home_blog' %}" class="btn btn-secondary">Back</a>

    <br/><br/>
    <hr>
    <br/><br/>
    <!-- Likes Section-->
    <form action="{% url 'like_post' post.pk %}" method="POST">
        {% csrf_token %}
        {% if user.is_authenticated %}
            {% if liked %}
                <button type="submit" name="post_id" value="{{ post.id }}" class="btn btn-danger btn-sm"> 
                    Unlike 
                </button> - 
                {{ total_likes }} Likes
            {% else %}
                <button type="submit" name="post_id" value="{{ post.id }}" class="btn btn-primary btn-sm"> 
                    Like 
                </button> - 
                {{ total_likes }} Likes
            {% endif %}
        {% else %}
            <small><a href="{% url 'login' %}">Log in</a> to Like</small> - 
            {{ total_likes }} Likes
        {% endif %}
    </form>
    <!-- End Likes Section-->
    
    <br/><br/>
    <hr>
    <div class="card mb-3" >
        <div class="row g-0">
            <div class="col-md-2">
                {% if post.author.profile.profile_pic %}
                    <img src="{{ post.author.profile.profile_pic.url}}" class="img-fluid rounded-start" alt="..." width=100 height=100 >
                {% else %}
                    <!--<h4> No Profile Pic</h4>-->
                    <img src="{% static 'blog/images/default_profile_img.jpg' %}" class="img-fluid rounded-start" alt="..." width=100 height=100 >
                {% endif %}
            </div>
            <div class="col-md-10">
                <div class="card-body">
                    <h5 class="card-title">
                        {{ post.author.first_name}} 
                        {{post.author.last_name}}
                    </h5>
                    <p class="card-text">{{ post.author.profile.bio}}</p>
                    <p class="card-text">
                        <small class="text-muted">
                            <a href="{% url 'show_profile_page' post.author.profile.id %}">Profile Page</a> 

                            {% if post.author.profile.website_url %}
                                | <a href="{{ post.author.profile.website_url}}">Website</a> 
                            {% endif %}

                            {% if post.author.profile.facebook_url %}
                                | <a href="{{ post.author.profile.facebook_url}}">Facebook</a>  
                            {% endif %}

                            {% if post.author.profile.instagram_url %}
                                | <a href="{{ post.author.profile.instagram_url}}">Instagram</a>  
                            {% endif %}

                            {% if post.author.profile.pinterest_url %}
                                | <a href="{{ post.author.profile.pinterest_url}}">Pinterest</a>
                            {% endif %}

                            {% if post.author.profile.twitter_url %}
                                | <a href="{{ post.author.profile.pinterest_url}}">Pinterest</a>
                            {% endif %}
                        </small></p>
                </div>
            </div>
        </div>
    </div>

<br/><br/>
    <hr>
    <!-- Start Comments -->
    <h2>Comments..</h2>
    {% if not post.comments.all %}
        No comments yet... <a href="{% url "add_comment" post.pk %}">Add one</a>
    {% else %}
    <a href="{% url "add_comment" post.pk %}"> Add comment</a>
    <br/>
    <br/>
        {% for comment in post.comments.all %}
            <strong> {{ comment.name}} -- {{ comment.date_added }} </strong>
            <br/>
            <p>{{ comment.body }}</p>
        {% endfor %}
        <a href="{% url "add_comment" post.pk %}"> Add comment</a>
    {% endif %}
    <!-- End Comments -->
    <br/><br/> {% endcomment %}

    <!-- ****** Blog Area Start ******* -->
    <section class="dento--blog-area mt-50">
        <div class="container">
        <div class="row">
            <div class="col-12 col-lg-10 mb-100">
            <!-- Blog Details Area -->
            <div class="blog-details-area">
                <img src="{% static '{{post.header_image.url}}' %}" alt="">

                <h2 class="post-title">{{ post.title}}</h2>
                <div class="post-meta">
                <a href="#"><i class="icon_clock_alt"></i> {{post.post_date}} </a>
                <a href="#"><i class="icon_chat_alt"></i> {{post.comments.count}} </a>
                {% if user.is_authenticated %}
                    {% if user.id == post.author.id %}
                        <a href="{% url 'update_post' post.pk %}" >Edit</a> 
                        <a href="{% url 'delete_post' post.pk %}" >Delete</a> 
                    {% endif %}
                {% endif %}
                </div>
                {{post.body|safe}}
            </div>

            <!-- Comments Area -->
            <div class="comment_area clearfix">
                <h5 class="title">{{post.comments.count}} Comments</h5>

                <ol>
                {% if not post.comments.all %}
                    <li> No comments yet... <a href="{% url "add_comment" post.pk %}"><strong>Add one</strong></a>
                    </li>
                {% else %}
                    {% for comment in post.comments.all %}
                        <!-- Single Comment Area -->
                        <li class="single_comment_area">
                            <!-- Comment Content -->
                            <div class="comment-content d-flex">
                            <!-- Comment Author -->
                            <div class="comment-author">
                                <img src="{% static 'website/img/bg-img/28.jpg' %}" alt="author">
                            </div>
                            <!-- Comment Meta -->
                            <div class="comment-meta">
                                <a href="#" class="post-author">{{ comment.name}} / <span> {{ comment.date_added }}</span></a>
                                <p>{{ comment.body }}</p>
                                <a href="{% url "add_comment" post.pk %}" class="comment-reply">Reply</a>
                            </div>
                            </div>
                        </li>
                    {% endfor %}
                    
                        
                {% endif %}
                </ol>
            </div>
                

            
            </div>



            </div>
            </div>
        </div>
        </div>
    </section>
    <!-- ****** Blog Area End ******* -->
    
{% endblock content %}